<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Perceptron Visual Lab</title>
    <link rel="stylesheet" href="/src/style.css" />
  </head>
  <body>
    <div id="app">
      <header class="hero">
        <div>
          <p class="eyebrow">Perceptron Visual Lab</p>
          <h1>Make the decision boundary move.</h1>
          <p class="subhead">A hands-on view of weights, mistakes, and linearly separable data.</p>
        </div>
        <div class="controls">
          <label>
            <span>Dataset</span>
            <select id="dataset">
              <option value="or">OR</option>
              <option value="xor">XOR</option>
            </select>
          </label>
          <label>
            <span>Switchboard size</span>
            <select id="grid-size">
              <option value="2">2×2</option>
              <option value="3" selected>3×3</option>
              <option value="4">4×4</option>
              <option value="5">5×5</option>
            </select>
          </label>
          <button id="step">Step</button>
          <button id="reset">Reset</button>
          <label>
            <span>Learning rate</span>
            <div class="lr-row">
              <input id="lr" type="range" min="0.1" max="2" step="0.1" value="1" />
              <span id="lr-value">1.0</span>
            </div>
          </label>
          <label>
            <span>API base</span>
            <input id="api-base" type="text" value="http://127.0.0.1:8000" />
          </label>
          <p class="hotkeys">Shortcuts: <strong>S</strong> step, <strong>R</strong> reset</p>
        </div>
      </header>

      <main class="grid">
        <section class="panel">
          <h2>2D Boundary</h2>
          <canvas id="plot" width="420" height="420"></canvas>
        </section>

        <section class="panel">
          <h2>Switchboard</h2>
          <div class="boards">
            <div>
              <h3>Input</h3>
              <canvas id="input" width="200" height="200"></canvas>
            </div>
            <div>
              <h3>Weights</h3>
              <canvas id="weights" width="200" height="200"></canvas>
            </div>
            <div>
              <h3>Contribution</h3>
              <canvas id="contrib" width="200" height="200"></canvas>
            </div>
          </div>
          <div class="meter">
            <span>Score</span>
            <strong id="score">0.00</strong>
          </div>
        </section>

        <section class="panel calc-panel">
          <h2>Step math</h2>
          <div class="calc">
            <div class="calc-grid">
              <div><span>Input x</span><strong id="calc-x">[-1, 1]</strong></div>
              <div><span>Label y</span><strong id="calc-y">+1</strong></div>
              <div><span>Weights w</span><strong id="calc-w">[0.00, 0.00]</strong></div>
              <div><span>Bias b</span><strong id="calc-b">0.00</strong></div>
              <div><span>Score s</span><strong id="calc-s">0.00</strong></div>
              <div><span>Prediction ŷ</span><strong id="calc-pred">+1</strong></div>
            </div>
            <p id="calc-score-eq" class="calc-eq">s = w1·x1 + w2·x2 + b</p>
            <p id="calc-update-eq" class="calc-eq">w ← w + η y x, b ← b + η y</p>
            <p id="calc-note" class="calc-note">No update yet.</p>
          </div>
        </section>

        <section class="panel explain">
          <h2>What happens on each step</h2>
          <div class="math">
            <p><strong>Score:</strong> <span>s = w · x + b</span></p>
            <p><strong>Prediction:</strong> <span>ŷ = sign(s)</span></p>
            <p><strong>Mistake?</strong> <span>y · s ≤ 0</span></p>
            <p><strong>Update (only if mistake):</strong> <span>w ← w + η y x, b ← b + η y</span></p>
          </div>
          <p class="detail">
            The input grid shows the switches (x). The weight grid shows the dials (w). The contribution grid
            shows each cell’s product xᵢ·wᵢ before the sum. The score meter is the sum of all contributions plus bias.
          </p>
          <p class="detail">
            For XOR, no single line separates the classes, so the boundary keeps moving without converging.
          </p>
        </section>
      </main>
    </div>

    <script type="module" src="/src/main.ts"></script>
  </body>
</html>
